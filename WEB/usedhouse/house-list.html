<!DOCTYPE html>
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>改善居所_北京我爱我家官网</title>
<link href="css/basic.css" rel="stylesheet">
<link href="css/list.css" rel="stylesheet">
    <link href="css/sale.css" rel="stylesheet">
<link rel="stylesheet" href="css/page.css">
    <style>
        .sousuo{
            line-height: 55px;
            color: #323232;
            font-size: 22px;
        }
    .clear{clear: both}
        .select{
            margin-left: 86px;
            position: relative;
            margin-top: 20px;
            width: 130px;
            margin-bottom: 20px;
            float: left;
           display: none;
        }
        .select.on{display: block;}
        .sel-option{
            border: 1px solid #535d6a;
            width: 120px;
            height: 30px;overflow: hidden;
            padding-right: 10px;
            position: relative;
            line-height: 30px;
            font-size: 14px;
            text-indent: 10px;
        }
        .sel-option em{
            display: block;
            position: absolute;
            right: 10px;
            top: 15px;
            border-width: 5px;
            border-color: #2b3036 transparent transparent transparent;
            border-style: solid;
        }
        .adrCon ul{
            display: none;
            position: absolute;
            z-index: 10;
            background-color: #fff;
            height: 150px; overflow-y: scroll;
            top: 30px;
        }
        .adrCon ul li{
            display: block;
            line-height: 30px;
            width: 130px;
            font-size: 14px;
            color: #535d6a;
            margin-right: 2px;
            text-indent: 10px;
        }
        .adrCon ul li:hover,.adrCon ul li.on{
            background-color: #fbb100;
            color: #fff;
        }
    </style>
    <script src="js/jquery-1.10.2.min.js"></script>
<body>
<!-- 导航 start -->
<header></header>
<!-- 导航 end -->
<!-- 普通选房\智能选房Tab切换 -->
<div class="pxTab">
   <p class="sousuo">条件搜索</p>
    <!-- select start -->
    <div class="pxMain">
        <div class="pxMain_con block">
            <ul class="tiaoBox">
                <li>
                    <h2 class="tTit" title="北京二手房出售">位置</h2>
                    <div class="tCon">
                        <dl class="adrMenu">
                            <dd class="curDd"><a href="javascript:void(0)">区域</a></dd>
                        </dl>
                    </div>
                    <div style="clear:both"></div>
                    <div class="adrCon">
                       <div class="select on">
                           <div class="sel-option"><em></em></div>
                           <ul class="province">
                               <li>北京</li>
                               <li>山西</li>
                               <li>天津</li>
                           </ul>
                       </div>
                        <div class="select select1">
                            <div class="sel-option"><em></em></div>
                            <ul class="city"></ul>
                        </div>
                        <div class="select select2">
                            <div class="sel-option"><em></em></div>
                            <ul class="county"></ul>
                        </div>
                        <div class="clear"></div>
                    </div>
                </li>
                <li>
                    <h2 class="tTit" title="北京二手房价格">总价</h2>
                    <div class="tCon">
                        <div class="iTxt">
                            <input id="priceLow" type="text"> ~ <input id="priceTop" type="text">
                            <span id="priceUnit"></span>
                            <!--<input class="btnQ" type="button" value="确定" onclick="customPrice();">-->
                        </div>
                    </div>
                </li>
                <li>
                    <h2 class="tTit" title="北京二手房面积">面积</h2>
                    <div class="tCon">
                        <div class="iTxt">
                            <input id="areaLow" type="text"> ~ <input id="areaTop" type="text">
                            <span id="areaUnit"></span>
                            <!--<input class="btnQ" type="button" value="确定" onclick="customArea();">-->
                        </div>
                    </div>
                </li>
                <li>
                    <h2 class="tTit" title="北京二手房户型">户型</h2>
                    <div class="tCon houseHall">
                        <a class="aa" href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>一室</span></a>
                        <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>二室</span></a>
                        <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>三室</span></a>
                        <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>四室</span></a>
                        <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>五室</span></a>
                        <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>五室以上</span></a>
                    </div>
                </li>
                <li>
                    <h2 class="tTit" title="北京二手房用途">类型</h2>
                    <div class="tCon houseType">
                        <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>普通住宅</span></a>
                        <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>公寓</span></a>
                        <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>平房</span></a>
                        <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>别墅</span></a>
                        <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>其它</span></a>
                    </div>
                </li>
                <li>
                    <div class="moreCon hide">
                        <ul>
                            <li>
                                <h2 class="tTit" title="北京二手房楼层">楼层</h2>
                                <div class="tCon floor">
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>低楼层</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>中楼层</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>高楼层</span></a>
                                </div>
                            </li>
                            <li>
                                <h2 class="tTit" title="北京二手房朝向">朝向</h2>
                                <div class="tCon direction">
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>南北</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>南</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>东</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>西</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>北</span></a>
                                </div>
                            </li>
                            <li>
                                <h2 class="tTit" title="北京二手房楼龄">楼龄</h2>
                                <div class="tCon">
                                    <div class="iTxt">
                                        <input id="ageLow" type="text"> ~ <input id="ageTop" type="text">
                                        <span id="ageUnit"></span>
                                        <!--<input class="btnQ" type="button" value="确定" onclick="">-->
                                    </div>
                                </div>
                            </li>
                            <li>
                                <h2 class="tTit" title="北京二手房装修">装修</h2>
                                <div class="tCon renovation">
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>精装修</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>普通装修</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>豪华装修</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>毛坯房</span></a>
                                </div>
                            </li>
                            <li>
                                <h2 class="tTit" title="北京二手房特色">标签</h2>
                                <div class="tCon tagName">
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>近地铁</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>随时看</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>满二年</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>满五年</span></a>
                                    <a href="javascript:void(0)" rel="nofollow"><span class="inputSty "></span><span>近公园</span></a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <div class="moreBtn">
                        <em class="bor1"></em>
                        <em class="bor2"></em>
                        <span>更多<i class="mBg"></i></span>
                    </div>
                </li>
                <li class="tj">
                    <h2 class="tTit" title="北京二手房条件">条件</h2>
                    <div class="tCon">
                        <div class="btn-box">
                            <em class="bcBtn" onclick="saveCondition();"><i></i>搜索</em>
                            <em class="qkBtn" onclick="cleanSelect();"><i></i>清空</em>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>
<!-- 普通选房\智能选房Tab切换 End-->
<!-- 有好房内容区 -->
<div class="hfBox mar marTop3">
    <!-- 有好房列表 -->
    <ul class="hfList">
       <li>
                            <div class="hfList_img">
                                <a href="house-detail.html" target="_blank">
                                    <img class="lazy" src="images/img9.jpg" style="display: block;">
                                </a>
                            </div>
                            <div class="hfList_con">
                                <div class="imgMiao">
                                    <div class="xiaoName ">
                                        <p><a href="house-detail.html" target="_blank">风林绿洲</a></p>
                                        <p>朝阳-南沙滩&nbsp;·&nbsp;2001年建成&nbsp;·&nbsp;板楼,塔楼</p>
                                    </div>
                                    <ul class="xiaoName_list">
                                        <li><i class="i_4"></i><span>内部环境:北五环内，有健身会所，带水景、园林景观，环境好，多为四居大户型，全封闭小区，24小时物业管理，地下停车位。                                </span></li>
                                        <li><i class="i_2"></i><span>周边配套:周边有新奥购物中心、解放军306医院、奥森公园等配套。                                </span></li>
                                        <li><i class="i_5"></i><span>交通:双地铁，距15号线与8号线交汇站（奥林匹克公园站）800余米。                                </span></li>
                                    </ul>
                                </div>
                           </div>
                            <p class="jia"><strong><em>59762</em></strong>元/m²</p>
                        </li>
        <li>
            <div class="hfList_img">
                <a href="house-detail.html" target="_blank">
                    <img class="lazy" src="images/img9.jpg" style="display: block;">
                </a>
            </div>
            <div class="hfList_con">
                <div class="imgMiao">
                    <div class="xiaoName ">
                        <p><a href="house-detail.html" target="_blank">风林绿洲</a></p>
                        <p>朝阳-南沙滩&nbsp;·&nbsp;2001年建成&nbsp;·&nbsp;板楼,塔楼</p>
                    </div>
                    <ul class="xiaoName_list">
                        <li><i class="i_4"></i><span>内部环境:北五环内，有健身会所，带水景、园林景观，环境好，多为四居大户型，全封闭小区，24小时物业管理，地下停车位。                                </span></li>
                        <li><i class="i_2"></i><span>周边配套:周边有新奥购物中心、解放军306医院、奥森公园等配套。                                </span></li>
                        <li><i class="i_5"></i><span>交通:双地铁，距15号线与8号线交汇站（奥林匹克公园站）800余米。                                </span></li>
                    </ul>
                </div>
            </div>
            <p class="jia"><strong><em>59762</em></strong>元/m²</p>
        </li>
        <li>
            <div class="hfList_img">
                <a href="house-detail.html" target="_blank">
                    <img class="lazy" src="images/img9.jpg" style="display: block;">
                </a>
            </div>
            <div class="hfList_con">
                <div class="imgMiao">
                    <div class="xiaoName ">
                        <p><a href="house-detail.html" target="_blank">风林绿洲</a></p>
                        <p>朝阳-南沙滩&nbsp;·&nbsp;2001年建成&nbsp;·&nbsp;板楼,塔楼</p>
                    </div>
                    <ul class="xiaoName_list">
                        <li><i class="i_4"></i><span>内部环境:北五环内，有健身会所，带水景、园林景观，环境好，多为四居大户型，全封闭小区，24小时物业管理，地下停车位。                                </span></li>
                        <li><i class="i_2"></i><span>周边配套:周边有新奥购物中心、解放军306医院、奥森公园等配套。                                </span></li>
                        <li><i class="i_5"></i><span>交通:双地铁，距15号线与8号线交汇站（奥林匹克公园站）800余米。                                </span></li>
                    </ul>
                </div>
            </div>
            <p class="jia"><strong><em>59762</em></strong>元/m²</p>
        </li>
    </ul>
    <div class="ts-page"></div>
    <!-- 有好房列表 End-->
</div>
<!-- 有好房内容区 End-->
<footer></footer>
<script src="js/jquery-1.10.2.min.js"></script>
<script src="js/cookie_util.js"></script>
<script src="js/common.js"></script>

<script src="js/BaseValues.js"></script>
<script src="js/timeFormat.js"></script>
<script>

    var objData={
        'houseHall':'',
        'houseType':'',
        'floor':'',
        'direction':'',
        'renovation':'',
        'tagName':''
    };

    var desc=sessionStorage.getItem('desc')?'':sessionStorage.getItem('desc');

    var myprovice,mycity,mydistrict;

    $('.moreBtn').click(function(){
        $(this).parents('li').hide();
        $('.tiaoBox').css('overflow','hidden')
        $('.moreCon').removeClass('hide')
    })

    $('.inputSty').click(function(){
        $(this).addClass('on_check').parents('a').siblings().find('.inputSty').removeClass('on_check');
    })

    
    function saveCondition() {
        objData={
            'houseHall':$('.houseHall').find('.on_check+span').html(),
            'houseType':$('.houseType').find('.on_check+span').html(),
            'floor':$('.floor').find('.on_check+span').html(),
            'direction':$('.direction').find('.on_check+span').html(),
            'renovation':$('.renovation').find('.on_check+span').html(),
            'tagName':$('.tagName').find('.on_check+span').html()
        };
        queryHouseDate();

    }

    
//清空
    function cleanSelect() {
        $('.tiaoBox .inputSty').removeClass('on_check')
        $('.tiaoBox input').val('');
    }

function init(){

    queryHouseDate();
//   省市区
    city(0)
}

//省市区
function city(myid){
    $.ajax({
        type:'get',
        url:basePath+'/district/list',
        data:{
            'districtId':myid
        },
        success:function(data){
            if(data.success){
                cityView(data.result,myid)
            }else{
                alert(data.message)
            }
        },
        error:function(data){
            alert(data)
        }
    })

}
function cityView(data,myid){
    if(!myid){
        $('.province').html('')
        $.each(data,function(n,value) {
            $('.province').append('<li data-id="'+value.districtId+'">'+value.districtName+'</li>')
        });
    }else if($('.city').html()==''){
        $.each(data,function(n,value) {
            $('.city').append('<li data-id="'+value.districtId+'">'+value.districtName+'</li>')
        });
    }else{
        $.each(data,function(n,value) {
            $('.county').append('<li data-id="'+value.districtId+'">'+value.districtName+'</li>')
        });
    }
//    事件在绑定
    $('.select').hover(function(){
        $(this).find('ul').stop().show()
    },function () {
        $(this).find('ul').stop().hide()
    })
    $('.select li').click(function () {
        $(this).parents('.select').find('.sel-option').html($(this).html()+'<em></em>')
        if($(this).parent('ul').hasClass('province')){
            $('.select1').addClass('on').find('ul').html('')
            myprovice=$(this).attr('data-id');
        }
        if($(this).parent('ul').hasClass('city')){
            $('.select2').addClass('on').find('ul').html('');
            mycity=$(this).attr('data-id');
        }
        if($(this).parent('ul').hasClass('district')){
            mydistrict=$(this).attr('data-id');
        }
        city($(this).attr('data-id'))
    })
}


function idVal(myid){
    return $('#'+myid).val()
}
var flag=false;
function queryHouseDate(page) {
    console.log(objData)
    page=page?page:1;
    $.ajax({
        type:'get',
        url:basePath+'/house/page',
        data:{
            'desc':desc,
            'provice':myprovice,
            'city':mycity,
            'district':mydistrict,
            'salePriceBegin':idVal('priceLow'),
            'salePriceEnd':idVal('priceTop'),
            'areaBegin':idVal('areaLow'),
            'areaEnd':idVal('areaTop'),
            'houseHall':objData.houseHall,
            'houseType':objData.houseType,
            'floor':objData.floor,
            'direction':objData.direction,
            'houseAgeBegin':idVal('ageLow'),
            'houseAgeEnd':idVal('ageTop'),
            'renovation':objData.renovation,
            'tagName':objData.tagName,
            'priceFlag':'',
            'unitPriceFlag':'',
            'areaFlag':'',
            'createFlag':'',
            'page':page,
            'pageSize':5
        },
        success:function(data){
            console.log(data)

            window.pages=Math.ceil(data.total/5);

            pageCount=window.pages;
            inserHtml(pageCount,1);
            bindEvent(pageCount)
            getView(data.rows)
        },
        error:function(data){
            alert(data)
        }
    })
}
function queryHouseDate1(page) {
        console.log(objData)
        page=page?page:1;
        $.ajax({
            type:'get',
            url:basePath+'/house/page',
            data:{
                'desc':desc,
                'provice':myprovice,
                'city':mycity,
                'district':mydistrict,
                'salePriceBegin':idVal('priceLow'),
                'salePriceEnd':idVal('priceTop'),
                'areaBegin':idVal('areaLow'),
                'areaEnd':idVal('areaTop'),
                'houseHall':objData.houseHall,
                'houseType':objData.houseType,
                'floor':objData.floor,
                'direction':objData.direction,
                'houseAgeBegin':idVal('ageLow'),
                'houseAgeEnd':idVal('ageTop'),
                'renovation':objData.renovation,
                'tagName':objData.tagName,
                'priceFlag':'',
                'unitPriceFlag':'',
                'areaFlag':'',
                'createFlag':'',
                'page':page,
                'pageSize':5
            },
            success:function(data){
                getView(data.rows)
            },
            error:function(data){
                alert(data)
            }
        })
    }

function getView(data) {
    $('.hfList').html('')

       $.each(data,function(i,item){

           var time=timeFormat(item.createTime);
           $('.hfList').append('  <li> ' +
               '<div class="hfList_img"> ' +
               '<a href="house-detail.html?houseId='+item.houseId+'" target="_blank"> ' +
               '<img class="lazy" src="'+item.majorAddr+'" style="display: block;"> </a> </div> ' +
               '<div class="hfList_con"> <div class="imgMiao"> <div class="xiaoName "> ' +
               '<p><a href="house-detail.html?houseId='+item.houseId+'" target="_blank">'+item.houseName+'</a></p> ' +
               '<p>'+item.direction+'-'+item.renovation+'&nbsp;·&nbsp;'+item.salePrice+'&nbsp;·&nbsp;'+item.floor+'楼层</p> </div> ' +
               '<ul class="xiaoName_list"> ' +
               '<li><i class="i_4"></i><span>内部环境:'+item.houseHall+'房屋面积:'+item.area+'平方米</span></li> ' +
               '<li><i class="i_2"></i><span>地理位置:'+item.addr+'</span></li> ' +
               '<li><i class="i_5"></i><span>发布时间:'+time+'</span></li> </ul> </div> </div> ' +
               '<p class="jia"><strong><em>'+item.unitPrice+'</em></strong>元/m²</p> ' +
               '</li>')
       })
    }

$(function(){
    init();
})
    function inserHtml(page,current){
        var obj = $(".ts-page");
        obj.empty();
        if(current > 1){
            obj.append('<span class="tspage-start">首页</span>');
            obj.append('<span class="tspage-before">上一页</span>');
        }else{
            obj.remove('.tspage-start');
            obj.append('<span class="tspage-before disable">上一页</span>');
        }
        if(current>3 && current <= page && page>5){
            obj.append('<span class="tspage-ell">...</span>');
        }
        var start = current-2, end= current+2; //中间显示5个
        // var start = current-2, end= current+2; //中间显示5个
        if(start >1 && current < 4||current == 1){
            end++;
        }
        if(current > page-2 && current <= page){
            start--;
        }
        for(;start<=end;start++){
            if(start<=page && start >=1){
                if(start != current){
                    obj.append('<span class="page">'+start+'</span>');
                }else{
                    obj.append('<span class="page on">'+start+'</span>');
                }
            }
        }
        if(current+2<page && current >=1 && page>4){
            obj.append('<span class="tspage-ell">...</span>');
        }
        if(current<page){
            obj.append('<span class="tspage-after">下一页</span>');
            obj.append('<span class="tspage-end">尾页</span>');
        }else{
            obj.remove('.tspage-end');
            obj.append('<span class="tspage-after disable">下一页</span>');
        }
    }
    function bindEvent(page){
        var obj = $(".ts-page");
        obj.on('click','.page',function(){
            var currentPage = parseInt($(this).text());
            inserHtml(currentPage,page);
            inserHtml(page,currentPage);
            //获取后台传来数据的ajax函数+数据适配
            getData(currentPage);
        });
        obj.on('click','.tspage-before',function(){
            var currentPage = parseInt(obj.children('.on').text());
            if(currentPage>1){
                inserHtml(page,currentPage-1);
                //获取后台传来数据的ajax函数+数据适配
                getData(currentPage-1);
            }

        });
        obj.on('click','.tspage-after',function(){
            var currentPage = parseInt(obj.children('.on').text());
            if(currentPage<page){
                inserHtml(page,currentPage+1);
                //获取后台传来数据的ajax函数+数据适配
                getData(currentPage+1);
            }
        });
        obj.on('click','.tspage-start',function(){
            inserHtml(page,1);
            //获取后台传来数据的ajax函数+数据适配
            getData(1);
        });
        obj.on('click','.tspage-end',function(){
            inserHtml(page,page);

            //获取后台传来数据的ajax函数+数据适配
            getData(page);
        });
    }
    function fun() {

    }
    function getData(num){
        /* $.get('url?p='+num,function(data){
         console.log(data); //这里是数据适配
         })*/
        queryHouseDate1(num)
    }
  var pageCount;
    window.pageCount=pageCount;
    window.inserHtml=inserHtml;
    window.bindEvent=bindEvent;
</script>
<script></script>
</body></html>